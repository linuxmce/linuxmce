#!/bin/sh

IP="$1"
MAC="$2"

DT_Panasonic_IP_Camera=47

sleep 5

for i in 1 2 3 4 5 6 7 8 9; do
#	if wget -qs http://$IP/CgiStart; then
	if curl --fail --connect-timeout 1 --max-time 1 http://$IP/CgiStart ;then
		IsPanasonic=1
		break
	fi
	sleep 1
done

if [[ -n "$IsPanasonic" ]]; then
	# It's a Panasonic IP camera
	/usr/bin/MessageSend 127.0.0.1 0 -1001 2 65 28 "$IP" 5 "$MAC" 49 "$DT_Panasonic_IP_Camera"
fi
