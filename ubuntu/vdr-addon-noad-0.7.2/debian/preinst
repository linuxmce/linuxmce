#! /bin/sh
# preinst script for vdr-addon-noad
#
# see: dh_installdeb(1)

set -e

# summary of how this script can be called:
#        * <new-preinst> `install'
#        * <new-preinst> `install' <old-version>
#        * <new-preinst> `upgrade' <old-version>
#        * <old-preinst> `abort-upgrade' <new-version>
#
# for details, see http://www.debian.org/doc/debian-policy/ or
# the debian-policy package

ACTION=$1

# In vdr version 1.2.6-14, the commands.*.conf have now an own subdirectory.
# This is for handling upgrades from older versions:
#
UpdateCommandHook ()
{
    case $ACTION in
        install|upgrade)
        # copy old commands.*.conf to new location
        mkdir -p /etc/vdr/command-hooks
        if [ ! -f /etc/vdr/command-hooks/$1 -a -f /etc/vdr/$1 ] ; then
            cp /etc/vdr/$1 /etc/vdr/command-hooks/$1
        fi
        ;;
        abort-upgrade)
        # remove copied files from new location
        [ -f /etc/vdr/$1 ] && rm -f /etc/vdr/command-hooks/$1
        rmdir /etc/vdr/command-hooks 2>/dev/null || true;
        ;;
    esac
}
UpdateCommandHook reccmds.noad.conf


# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
