<?php

function logfiles_highlight_asterisk($line) {
	$apps = array(
	'AddQueueMember',
	'ADSIProg',
	'AGI',
	'Answer',
	'Authenticate',
	'BackGround',
	'BackgroundDetect',
	'Bridge',
	'Busy',
	'ChangeMonitor',
	'ChanIsAvail',
	'ChannelRedirect',
	'ChanSpy',
	'ClearHash',
	'ConfBridge',
	'Congestion',
	'ContinueWhile',
	'ControlPlayback',
	'DAHDIAcceptR2Call',
	'DAHDIBarge',
	'DAHDIRAS',
	'DAHDIScan',
	'DAHDISendKeypadFacility',
	'DateTime',
	'DBdel',
	'DBdeltree',
	'DeadAGI',
	'Dial',
	'Dictate',
	'Directory',
	'DISA',
	'DumpChan',
	'EAGI',
	'Echo',
	'EndWhile',
	'Exec',
	'ExecIf',
	'ExecIfTime',
	'ExitWhile',
	'ExtenSpy',
	'ExternalIVR',
	'Flash',
	'ForkCDR',
	'GetCPEID',
	'Gosub',
	'GosubIf',
	'Goto',
	'GotoIf',
	'GotoIfTime',
	'Hangup',
	'IAX2Provision',
	'ICES',
	'ImportVar',
	'Incomplete',
	'Log',
	'Macro',
	'MacroExclusive',
	'MacroExit',
	'MacroIf',
	'MailboxExists',
	'MeetMe',
	'MeetMeAdmin',
	'MeetMeChannelAdmin',
	'MeetMeCount',
	'Milliwatt',
	'MinivmAccMess',
	'MinivmDelete',
	'MinivmGreet',
	'MinivmMWI',
	'MinivmNotify',
	'MinivmRecord',
	'MixMonitor',
	'Monitor',
	'Morsecode',
	'MP3Player',
	'MSet',
	'MusicOnHold',
	'MYSQL',
	'NBScat',
	'NoCDR',
	'NoOp',
	'Originate',
	'Page',
	'Park',
	'ParkAndAnnounce',
	'ParkedCall',
	'PauseMonitor',
	'PauseQueueMember',
	'Pickup',
	'PickupChan',
	'Playback',
	'PlayTones',
	'PrivacyManager',
	'Proceeding',
	'Progress',
	'Queue',
	'QueueLog',
	'RaiseException',
	'Read',
	'ReadExten',
	'ReadFile',
	'Record',
	'RemoveQueueMember',
	'ResetCDR',
	'RetryDial',
	'Return',
	'Ringing',
	'SayAlpha',
	'SayCountPL',
	'SayDigits',
	'SayNumber',
	'SayPhonetic',
	'SayUnixTime',
	'SendDTMF',
	'SendImage',
	'SendText',
	'SendURL',
	'Set',
	'SetAMAFlags',
	'SetCallerPres',
	'SetMusicOnHold',
	'SIPAddHeader',
	'SIPDtmfMode',
	'SIPRemoveHeader',
	'SLAStation',
	'SLATrunk',
	'SMS',
	'SoftHangup',
	'SpeechActivateGrammar',
	'SpeechBackground',
	'SpeechCreate',
	'SpeechDeactivateGrammar',
	'SpeechDestroy',
	'SpeechLoadGrammar',
	'SpeechProcessingSound',
	'SpeechStart',
	'SpeechUnloadGrammar',
	'StackPop',
	'StartMusicOnHold',
	'StopMixMonitor',
	'StopMonitor',
	'StopMusicOnHold',
	'StopPlayTones',
	'System',
	'TestClient',
	'TestServer',
	'Transfer',
	'TryExec',
	'TrySystem',
	'UnpauseMonitor',
	'UnpauseQueueMember',
	'UserEvent',
	'Verbose',
	'VMAuthenticate',
	'VoiceMail',
	'VoiceMailMain',
	'Wait',
	'WaitExten',
	'WaitForNoise',
	'WaitForRing',
	'WaitForSilence',
	'WaitMusicOnHold',
	'WaitUntil',
	'While',
	'Zapateller'
	);
	$line = preg_replace('/(?:' . implode($apps, '|') . ')(?=\()/', '<span class="app">$0</span>', $line, 1);
	$line = preg_replace('/(?<=\(\").*(?=\"\,)/', '<span class="appargs">$0</span>', $line, 1);
	$line = preg_replace('/(?<=\,( )\").*(?=\"\))/', '<span class="appargs">$0</span>', $line, 1);
	return $line;
}
?>